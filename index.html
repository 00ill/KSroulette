<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
	<style>
		* {
			box-sizing: border-box;
		}
		html, body {
			width: 100%;
			height: 100%;
			margin: 0;
			padding: 0;
		}

		canvas {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			right: 0;
			bottom: 0;
		}

		#settings {
			background: rgba(255, 255, 255, 0.8);
			position: absolute;
			bottom: 5%;
			left: 5%;
			width: 400px;
			max-width: 90%;
			padding: 1em;
			z-index: 100;
		}

		textarea {
			width: 100%;
			height: 10em;
		}

		div.actions {
			text-align: right;
		}
	</style>
</head>
<body>
<script type="module" src="./src/index.ts"></script>
<script type="text/javascript">
	function getNames() {
		const value = document.querySelector('#in_names').value.trim();
		return value.split(/[,\r\n]/g).map(v => v.trim()).filter(v => !!v);
	}

	let ready = false;

	document.addEventListener('DOMContentLoaded', () => {
		document.querySelector('#in_names').addEventListener('input', () => {
			const names = getNames();
			window.roullete.setMarbles(names);
			if (names.length > 0) {
				ready = true;
			}
		});

		document.querySelector('#btnShuffle').addEventListener('click', () => {
			const names = getNames();
			window.roullete.setMarbles(names);
			if (names.length > 0) {
				ready = true;
			}
		});

		document.querySelector('#btnStop').addEventListener('click', () => {
			window.roullete.reset();
			ready = false;
		});

		document.querySelector('#btnStart').addEventListener('click', () => {
			if (!ready) return;

			window.roullete.start();
			document.querySelector('#settings').style.display = 'none';
		});

		window.roullete.addEventListener('goal', () => {
			ready = false;
			document.querySelector('#settings').style.display = 'block';
		});

		document.querySelector('#btnShuffle').click();
	});
</script>
<div id="settings">
	<textarea id="in_names" placeholder="Input names saparated by commas or line feed here">a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z</textarea>
	<div class="actions">
		<button id="btnStop">Stop</button>
		<button id="btnStart">Start</button>
		<button id="btnShuffle">Shuffle</button>
	</div>
</div>
</body>
</html>
